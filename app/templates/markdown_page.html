<!-- app/templates/markdown_page.html -->
{% extends "base.html" %}

{% block title %}{{ title }} - Notes Scanner{% endblock %}

{% block styles %}
<link rel="stylesheet" href="/static/css/markdownViewer.css">
<link rel="stylesheet" href="/static/css/markdownPage.css">
{% endblock %}

{% block content %}
<div class="markdown-page">
    <header class="page-header">
        <nav class="nav-bar">
            <a href="/sessions-page" class="back-link">‚Üê Back to Sessions</a>
            <div class="actions">
                <button onclick="window.print()" class="action-button" title="Print">
                    üñ®Ô∏è Print
                </button>
                <button onclick="shareDocument()" class="action-button" title="Share">
                    üì§ Share
                </button>
            </div>
        </nav>
        <h1 class="page-title">{{ title }}</h1>
    </header>

    <main class="markdown-content" id="content">
        {{ content }}
    </main>

    <footer class="page-footer">
        <p>Generated by Notes Scanner</p>
    </footer>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
<script>
    document.addEventListener("DOMContentLoaded", function() {
        // Configure marked
        marked.setOptions({
            breaks: true,  // Enable line breaks
            gfm: true,    // Enable GitHub Flavored Markdown
            headerIds: true,
            mangle: false
        });

        // Get the content and render it
        const contentElement = document.getElementById('content');
        const rawContent = contentElement.textContent;  // Get the raw markdown
        contentElement.innerHTML = marked.parse(rawContent);  // Parse and render it

        // Then render math
        renderMathInElement(contentElement, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>
{% endblock %}